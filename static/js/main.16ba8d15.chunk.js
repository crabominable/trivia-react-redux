(this["webpackJsonptrivia-test"]=this["webpackJsonptrivia-test"]||[]).push([[0],{35:function(e,t,a){e.exports=a(55)},44:function(e,t,a){},46:function(e,t,a){},48:function(e,t){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(19),c=a.n(i),s=a(9),o=(a(44),a(12)),l=a(16),u=a(21),m=a(22),d=a.n(m),h=a(3),p=a(4),b=a(6),g=a(5),f=a(2),v=a(7),k=(a(46),a(30)),y=a.n(k),E=function(){return fetch("https://opentdb.com/api.php?amount=5&token=".concat(localStorage.getItem("token"))).then((function(e){return e.json().then((function(t){return e.ok?Promise.resolve(t):Promise.reject(t)}))}))},O=function(e,t){return{type:"SET_TIMER",timer:e,answer:t}},j=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(b.a)(this,Object(g.a)(t).call(this))).state={email:"",name:"",valid:!1},e.validLogin=e.validLogin.bind(Object(f.a)(e)),e.handleForm=e.handleForm.bind(Object(f.a)(e)),e.requestToken=e.requestToken.bind(Object(f.a)(e)),e.handleHash=e.handleHash.bind(Object(f.a)(e)),e}return Object(v.a)(t,e),Object(p.a)(t,[{key:"requestToken",value:function(){var e,t,a,n,r,i,c,s,o;return d.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props,t=e.getAPI,a=e.sendFormLogin,n=this.state,r=n.email,i=n.name,a(r,i),c={player:{name:document.getElementById("name").value,assertions:0,score:0,gravatarEmail:document.getElementById("email").value},ranking:null!==localStorage.getItem("state")?JSON.parse(localStorage.getItem("state")).ranking:[]},localStorage.setItem("state",JSON.stringify(c)),this.handleHash(),l.next=8,d.a.awrap(fetch("https://opentdb.com/api_token.php?command=request"));case 8:return s=l.sent,l.next=11,d.a.awrap(s.json());case 11:o=l.sent,localStorage.setItem("token",o.token),t();case 14:case"end":return l.stop()}}),null,this)}},{key:"handleForm",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(u.a)({},a,n)),this.validLogin()}},{key:"validLogin",value:function(){var e=this.state,t=e.email,a=e.name,n=null!==t.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i),r=a.length>=1;!0===n&&!0===r&&this.setState({valid:!0})}},{key:"handleHash",value:function(){var e=this.state.email,t=y()(e).toString();localStorage.setItem("hash",t)}},{key:"render",value:function(){var e=this.state,t=e.valid,a=e.name;return r.a.createElement("div",{className:"login-screen"},r.a.createElement("div",{className:"login-title"},r.a.createElement("h1",null,"Trivia Time!")),r.a.createElement("div",{className:"login-panel"},r.a.createElement("label",{htmlFor:"email"},"Email:",r.a.createElement("input",{id:"email",name:"email",type:"email","data-testid":"input-gravatar-email",onChange:this.handleForm})),r.a.createElement("label",{htmlFor:"password"},"Name:",r.a.createElement("input",{id:"name",name:"name",type:"text","data-testid":"input-player-name",onChange:this.handleForm})),r.a.createElement(o.b,{to:{pathname:"/game",state:{name:a}}},t?r.a.createElement("input",{type:"Button",onClick:this.requestToken,value:"Jogar","data-testid":"btn-play",className:"btn-login-screen play"}):r.a.createElement("input",{type:"Button",value:"Jogar","data-testid":"btn-play",disabled:!0})),r.a.createElement(o.b,{to:"/settings"},r.a.createElement("input",{type:"Button",defaultValue:"Configuracao",className:"btn-login-screen","data-testid":"btn-settings"}))))}}]),t}(r.a.Component),S=Object(s.b)(null,(function(e){return{getAPI:function(){return e((function(e){return e({type:"fetchAPI"}),E().then((function(t){return e(function(e){return{type:"FETCH_API_SUCESS",payload:e}}(t))}),(function(){return e("FETCH_API_ERROR"())}))}))},sendFormLogin:function(t,a){return e(function(e,t){return{type:"GET_USER",email:e,name:t}}(t,a))}}}))(j),N=(a(50),function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.point;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-logos"},r.a.createElement("img",{src:"https://i.pinimg.com/originals/89/74/82/897482d89aa1a4b266a7ee8b0dbd8f8e.gif",alt:"pixel art asas batendo",className:"header-wings"}),r.a.createElement("span",{className:"header-game-title"},"Trivia")),r.a.createElement("div",{className:"header-infos"},r.a.createElement("img",{"data-testid":"header-profile-picture",alt:"img-profile",src:"https://www.gravatar.com/avatar/".concat(localStorage.getItem("hash")),className:"header-img"}),r.a.createElement("span",{"data-testid":"header-player-name",className:"header-text"},t),r.a.createElement("span",{className:"header-text","data-testid":"header-score"},a)),r.a.createElement("div",{className:"header-logos"},r.a.createElement("span",{className:"header-game-title"},"Time!"),r.a.createElement("img",{src:"https://i.pinimg.com/originals/81/d5/4a/81d54a65efdeba6a87f20229861da00e.gif",alt:"pixel art asas batendo",className:"header-wings"})))}}]),t}(r.a.Component)),w=Object(s.b)((function(e){var t=e.game,a=e.user;return{answers:t.answer,loading:t.isLoading,name:a.name,timer:t.timer,point:t.point}}),null)(N),C=a(34),I=a(8),x=(a(51),function(e){function t(e){var a;Object(h.a)(this,t),a=Object(b.a)(this,Object(g.a)(t).call(this,e));var n=localStorage.getItem("state");return a.state={indexQuestion:0,isCorrect:"",isIncorrect:"",player:JSON.parse(n)},a.renderGame=a.renderGame.bind(Object(f.a)(a)),a.handleBotao=a.handleBotao.bind(Object(f.a)(a)),a.handleClick=a.handleClick.bind(Object(f.a)(a)),a.setTimer=a.setTimer.bind(Object(f.a)(a)),a.nextAnswers=a.nextAnswers.bind(Object(f.a)(a)),a.setState=a.setState.bind(Object(f.a)(a)),a.mudarState=a.mudarState.bind(Object(f.a)(a)),a.handleClickQuestion=a.handleClickQuestion.bind(Object(f.a)(a)),a.renderButtonWithLink=a.renderButtonWithLink.bind(Object(f.a)(a)),a.renderButtonWithoutLink=a.renderButtonWithoutLink.bind(Object(f.a)(a)),a.savePlayerRanking=a.savePlayerRanking.bind(Object(f.a)(a)),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.setTimer()}},{key:"componentDidUpdate",value:function(){var e=localStorage.getItem("state"),t=this.props.point,a=Object(I.a)({},JSON.parse(e),{player:Object(I.a)({},JSON.parse(e).player,{score:t})});localStorage.setItem("state",JSON.stringify(a))}},{key:"setScore",value:function(e){var t=this.props,a=t.timer,n=t.pergunta,r=t.setPoint,i=n[this.state.indexQuestion].difficulty;r("correct"===e?10+a*{easy:1,medium:2,hard:3}[i]:0),this.mudarState()}},{key:"setTimer",value:function(){var e=this,t=setInterval((function(){var a=e.props,n=a.loading,r=a.reduxTimer,i=a.question,c=a.timer;if(c<=0||!0===i)clearInterval(t),r(c,i),Array.from(document.getElementsByClassName("botao")).forEach((function(e){e.disabled=!0}));else if(!1===n){r(parseFloat(c)-1,i)}}),1e3)}},{key:"mudarState",value:function(){var e=this.props.point;this.setState((function(t){return Object(I.a)({},t,{player:parseFloat(t.player.point)+e})}))}},{key:"handleBotao",value:function(e,t){var a=this.state.isIncorrect;return r.a.createElement("button",{"data-testid":"wrong-answer-".concat(t),className:"".concat(a," botao"),type:"button",value:"incorrect",key:t,onClick:this.handleClick},e)}},{key:"handleClick",value:function(e){var t=e.target.value,a=localStorage.getItem("state"),n=this.props,r=n.reduxTimer,i=n.timer;if("correct"===t){this.setState({isCorrect:t,isIncorrect:"incorrect"}),this.setScore("correct");var c=Object(I.a)({},JSON.parse(a),{player:Object(I.a)({},JSON.parse(a).player,{assertions:JSON.parse(a).player.assertions+1})});localStorage.setItem("state",JSON.stringify(c))}else"incorrect"===t&&(this.setState({isCorrect:"correct",isIncorrect:t}),this.setScore("incorrect"));r(i,!0)}},{key:"handleClickQuestion",value:function(){var e=this.props.reduxTimer;this.setState((function(e){return{indexQuestion:e.indexQuestion+1,isCorrect:"",isIncorrect:""}})),Array.from(document.getElementsByClassName("botao")).forEach((function(e){e.disabled=!1}));e(30,!1),this.setTimer()}},{key:"nextAnswers",value:function(){return 4===this.state.indexQuestion?this.renderButtonWithLink():this.renderButtonWithoutLink()}},{key:"savePlayerRanking",value:function(){var e=localStorage.getItem("state"),t={name:JSON.parse(e).player.name,score:JSON.parse(e).player.score,picture:"https://www.gravatar.com/avatar/".concat(localStorage.getItem("hash"))},a=Object(I.a)({},JSON.parse(e),{ranking:[].concat(Object(C.a)(JSON.parse(e).ranking),[t])});localStorage.setItem("state",JSON.stringify(a))}},{key:"renderButtonWithLink",value:function(){return r.a.createElement(o.b,{to:"/feedback"},r.a.createElement("button",{type:"button","data-testid":"btn-next",className:"feedback",onClick:this.savePlayerRanking},"Feedback"))}},{key:"renderButtonWithoutLink",value:function(){return r.a.createElement("button",{type:"button",className:"next-question",onClick:this.handleClickQuestion,"data-testid":"btn-next"},"Proxima Pergunta")}},{key:"renderGame",value:function(){var e=this,t=this.props,a=t.pergunta,n=t.question,i=this.state,c=i.indexQuestion,s=i.isCorrect;return r.a.createElement("div",{className:"game-content"},r.a.createElement("h1",{"data-testid":"question-category",className:"question"},"Category: ".concat(a[c].category)),r.a.createElement("h1",{className:"question","data-testid":"question-text"},a[c].question),r.a.createElement("img",{className:"bat",src:"https://thumbs.gfycat.com/ActiveCheerfulBarnacle-max-1mb.gif",alt:"curious bat"}),r.a.createElement("div",{className:"game-content buttons"},r.a.createElement("button",{type:"button",className:"".concat(s," botao"),"data-testid":"correct-answer",value:"correct",onClick:this.handleClick},a[c].correct_answer),a[c].incorrect_answers.map((function(t,a){return e.handleBotao(t,a)})),!0===n?this.nextAnswers():null))}},{key:"render",value:function(){return!0===this.props.answer.isLoading?r.a.createElement("div",{className:"loading"},"Loading..."):this.renderGame()}}]),t}(r.a.Component)),T=Object(s.b)((function(e){return{loading:e.game.isLoading,answer:e.game,timer:e.game.timer,question:e.game.question,pergunta:e.game.answer,point:e.game.point}}),(function(e){return{reduxTimer:function(t,a){return e(O(t,a))},setPoint:function(t){return e(function(e){return{type:"SET_POINT",point:e}}(t))}}}))(x),P=function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.data,t=e.name,a=e.score,n=e.picture;return r.a.createElement("div",{className:"ranking-content-items"},r.a.createElement("img",{alt:"img-profile",src:n}),r.a.createElement("span",{"data-testid":"player-name-".concat(t)},t),r.a.createElement("span",{"data-testid":"player-score-".concat(a)},"Score: ".concat(a)))}}]),t}(r.a.Component),R=(a(52),function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.location.state.name,a=e.timer;return r.a.createElement(r.a.Fragment,null,r.a.createElement(w,{name:t}),r.a.createElement(T,{onClick:this.setAnswer}),r.a.createElement("div",{className:"timer"},r.a.createElement("span",null,a)))}}]),t}(r.a.Component)),J=Object(s.b)((function(e){var t=e.game;return{loading:t.isLoading,question:t.question,timer:t.timer}}),(function(e){return{reduxTimer:function(t,a){return e(O(t,a))}}}))(R),A=function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("h1",{"data-testid":"settings-title"},"Configura\xe7\xf5es")}}]),t}(r.a.Component),B=(a(53),function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(b.a)(this,Object(g.a)(t).call(this,e))).handleFeedback=a.handleFeedback.bind(Object(f.a)(a)),a.handleRanking=a.handleRanking.bind(Object(f.a)(a)),a.handlePlayAgain=a.handlePlayAgain.bind(Object(f.a)(a)),a.handleButtRanking=a.handleButtRanking.bind(Object(f.a)(a)),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"handleFeedback",value:function(){var e=localStorage.getItem("state");return JSON.parse(e).player.assertions<3?r.a.createElement("h1",{"data-testid":"feedback-text",className:"feedback-text"},"Podia ser melhor..."):JSON.parse(e).player.assertions>=3?r.a.createElement("h1",{"data-testid":"feedback-text",className:"feedback-text"},"Mandou bem!"):void 0}},{key:"handleRanking",value:function(){var e=localStorage.getItem("state");return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"feedback-score","data-testid":"feedback-total-score"},JSON.parse(e).player.score),r.a.createElement("h1",{"data-testid":"feedback-total-question",className:"feedback-score"},JSON.parse(e).player.assertions))}},{key:"handlePlayAgain",value:function(){var e=this.props.reset;return r.a.createElement(o.b,{to:"/"},r.a.createElement("button",{type:"button","data-testid":"btn-play-again",onClick:function(){return e()}},"Jogar Novamente"))}},{key:"handleButtRanking",value:function(){return r.a.createElement(o.b,{to:"/ranking"},r.a.createElement("button",{type:"button","data-testid":"btn-ranking"},"Ranking"))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w,null),r.a.createElement("div",{className:"feedback-content"},this.handleFeedback(),this.handleRanking(),r.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/commons/5/5e/Worthy_artistic_new_year_fireworks_.gif",alt:"fireworks",className:"fireworks"}),this.handlePlayAgain(),this.handleButtRanking()))}}]),t}(r.a.Component)),L=Object(s.b)(null,(function(e){return{reset:function(){return e({type:"RESET"})}}}))(B),F=(a(54),function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(b.a)(this,Object(g.a)(t).call(this,e))).handlePlayAgain=a.handlePlayAgain.bind(Object(f.a)(a)),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"handlePlayAgain",value:function(){var e=this.props.reset;return r.a.createElement(o.b,{to:"/"},r.a.createElement("button",{type:"button","data-testid":"btn-go-home",onClick:function(){return e()}},"Jogar Novamente"))}},{key:"render",value:function(){var e=localStorage.getItem("state");return r.a.createElement("div",{className:"div-button"},r.a.createElement("div",{className:"ranking-content"},r.a.createElement("div",{className:"ranking-content-inside"},r.a.createElement("h1",{"data-testid":"ranking-title"},"RANKING"),JSON.parse(e).ranking.sort((function(e,t){return t.score-e.score})).map((function(e,t){return r.a.createElement(P,{key:t,data:e})})))),this.handlePlayAgain())}}]),t}(r.a.Component)),_=Object(s.b)(null,(function(e){return{reset:function(){return e({type:"RESET"})}}}))(F);var q=function(){return r.a.createElement(o.a,{basename:"/trivia-react-redux"},r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/game",component:J}),r.a.createElement(l.a,{path:"/settings",component:A}),r.a.createElement(l.a,{path:"/feedback",component:L}),r.a.createElement(l.a,{path:"/ranking",component:_}),r.a.createElement(l.a,{exact:!0,path:"/",component:S})))},Q=a(15),W=a(32),H=a(33),G={email:"",name:""},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USER":return Object(I.a)({},e,{email:t.email,name:t.name});default:return e}},M={isLoading:!0,erro:null,answer:{},timer:30,question:!1,point:0},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"fetchAPI":return Object(I.a)({},e,{isLoading:!0});case"FETCH_API_SUCESS":return Object(I.a)({},e,{isLoading:!1,answer:t.payload.results});case"FETCH_API_ERROR":return Object(I.a)({},e,{isLoading:!1,erro:"DEU RUIM"});case"SET_TIMER":return Object(I.a)({},e,{timer:t.timer,question:t.answer});case"SET_POINT":return Object(I.a)({},e,{point:e.point+t.point});case"RESET":return{isLoading:!0,erro:null,answer:{},timer:30,question:!1,point:0};default:return e}},K=Object(Q.combineReducers)({user:U,game:D}),V=Object(Q.createStore)(K,Object(W.composeWithDevTools)(Object(Q.applyMiddleware)(H.a)));window.Cypress&&(window.store=V);var $=V;c.a.render(r.a.createElement(s.a,{store:$},r.a.createElement(q,null)),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.16ba8d15.chunk.js.map